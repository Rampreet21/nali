<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduTrack Pro - Teacher Portal</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
    --primary: #4361ee;
    --primary-dark: #3a56d4;
    --secondary: #3f37c9;
    --success: #4cc9f0;
    --danger: #f72585;
    --warning: #f8961e;
    --info: #4895ef;
    --light: #f8f9fa;
    --dark: #212529;
    --gray: #6c757d;
    --white: #ffffff;
    --sidebar-width: 280px; 
    --transition: all 0.3s ease;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Poppins', sans-serif;
    background-color: #f5f7fa;
    color: var(--dark);
    line-height: 1.6;
    overflow-x: hidden;
}

.app-container {
    display: flex;
    min-height: 100vh;
}

/* Sidebar Styles */
.sidebar {
    width: var(--sidebar-width);
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: var(--white);
    padding: 20px 0;
    position: fixed;
    height: 100vh;
    transition: var(--transition);
    z-index: 100;
    box-shadow: 4px 0 10px rgba(0, 0, 0, 0.1);
}

.sidebar-header {
    padding: 0 20px 20px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    margin-bottom: 20px;
}

.sidebar-header h2 {
    display: flex;
    align-items: center;
    gap: 10px;
    font-weight: 600;
}

.sidebar-header h2 i {
    font-size: 1.5rem;
}

.sidebar-menu {
    padding: 0 10px;
}

.menu-item {
    display: flex;
    align-items: center;
    padding: 12px 15px;
    margin-bottom: 5px;
    border-radius: 6px;
    color: var(--white);
    text-decoration: none;
    transition: var(--transition);
}

.menu-item:hover, .menu-item.active {
    background-color: rgba(255, 255, 255, 0.1);
}

.menu-item i {
    margin-right: 10px;
    font-size: 1.1rem;
    width: 24px;
    text-align: center;
}

/* Main Content Styles */
.main-content {
    flex: 1;
    margin-left: var(--sidebar-width);
    transition: var(--transition);
    padding: 20px;
}

.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 25px;
    background-color: var(--white);
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    margin-bottom: 25px;
}

.header-title h1 {
    font-size: 1.5rem;
    font-weight: 600;
    color: var(--dark);
}

.header-actions {
    display: flex;
    align-items: center;
    gap: 15px;
}

.user-profile {
    display: flex;
    align-items: center;
    gap: 10px;
    position: relative;
}

.user-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: var(--primary);
    color: var(--white);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition);
}

.user-avatar:hover {
    transform: scale(1.05);
}

.profile-dropdown {
    position: absolute;
    top: 50px;
    right: 0;
    background-color: var(--white);
    border-radius: 8px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    width: 250px;
    z-index: 1000;
    display: none;
    animation: fadeIn 0.2s ease;
}

.profile-dropdown.active {
    display: block;
}

.profile-header {
    padding: 15px;
    border-bottom: 1px solid #eee;
    display: flex;
    align-items: center;
    gap: 10px;
}

.profile-header .avatar-lg {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background-color: var(--primary);
    color: var(--white);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    font-size: 1.2rem;
}

.profile-info h4 {
    margin: 0;
    font-size: 1rem;
}

.profile-info p {
    margin: 3px 0 0;
    font-size: 0.8rem;
    color: var(--gray);
}

.profile-menu {
    padding: 10px 0;
}

.profile-menu a {
    display: block;
    padding: 10px 15px;
    color: var(--dark);
    text-decoration: none;
    transition: var(--transition);
}

.profile-menu a:hover {
    background-color: #f5f7fa;
}

.profile-menu a i {
    width: 20px;
    margin-right: 8px;
    color: var(--gray);
}

.notification-icon {
    position: relative;
    cursor: pointer;
}

.notification-badge {
    position: absolute;
    top: -5px;
    right: -5px;
    background-color: var(--danger);
    color: var(--white);
    border-radius: 50%;
    width: 18px;
    height: 18px;
    font-size: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.notification-dropdown {
    position: absolute;
    top: 50px;
    right: 0;
    background-color: var(--white);
    border-radius: 8px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    width: 300px;
    z-index: 1000;
    display: none;
    animation: fadeIn 0.2s ease;
}

.notification-dropdown.active {
    display: block;
}

.notification-header {
    padding: 15px;
    border-bottom: 1px solid #eee;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.notification-header h4 {
    margin: 0;
    font-size: 1rem;
}

.notification-header a {
    font-size: 0.8rem;
    color: var(--primary);
    text-decoration: none;
}

.notification-list {
    max-height: 300px;
    overflow-y: auto;
}

.notification-item {
    padding: 12px 15px;
    border-bottom: 1px solid #eee;
    transition: var(--transition);
}

.notification-item:hover {
    background-color: #f5f7fa;
}

.notification-item.unread {
    background-color: rgba(67, 97, 238, 0.05);
}

.notification-item .notification-title {
    font-weight: 500;
    margin-bottom: 5px;
    display: flex;
    justify-content: space-between;
}

.notification-item .notification-time {
    font-size: 0.75rem;
    color: var(--gray);
}

.notification-item .notification-message {
    font-size: 0.85rem;
    color: var(--gray);
}

/* Card Styles */
.card {
    background-color: var(--white);
    border-radius: 10px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    margin-bottom: 25px;
    transition: var(--transition);
    border: none;
}

.card:hover {
    box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
    transform: translateY(-2px);
}

.card-header {
    padding: 15px 20px;
    border-bottom: 1px solid rgba(0, 0, 0, 0.05);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.card-header h3 {
    font-weight: 600;
    color: var(--dark);
    margin: 0;
}

.card-body {
    padding: 20px;
}

/* Form Styles */
.form-group {
    margin-bottom: 20px;
}

.form-label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
    color: var(--dark);
}

.form-control {
    width: 100%;
    padding: 12px 15px;
    border: 1px solid #e0e0e0;
    border-radius: 6px;
    font-size: 0.95rem;
    transition: var(--transition);
}

.form-control:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
    outline: none;
}

.form-row {
    display: flex;
    flex-wrap: wrap;
    margin: 0 -10px;
}

.form-col {
    flex: 1;
    padding: 0 10px;
    min-width: 250px;
}

/* Button Styles */
.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 10px 20px;
    border-radius: 6px;
    font-weight: 500;
    cursor: pointer;
    transition: var(--transition);
    border: none;
    font-size: 0.95rem;
}

.btn i {
    margin-right: 8px;
}

.btn-primary {
    background-color: var(--primary);
    color: var(--white);
}

.btn-primary:hover {
    background-color: var(--primary-dark);
}

.btn-success {
    background-color: var(--success);
    color: var(--white);
}

.btn-success:hover {
    background-color: #3ab4d8;
}

.btn-danger {
    background-color: var(--danger);
    color: var(--white);
}

.btn-danger:hover {
    background-color: #e5177a;
}

.btn-warning {
    background-color: var(--warning);
    color: var(--white);
}

.btn-warning:hover {
    background-color: #e68a1b;
}

.btn-sm {
    padding: 6px 12px;
    font-size: 0.85rem;
}

/* Table Styles */
.table-responsive {
    overflow-x: auto;
}

.table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    background-color: var(--white);
    border-radius: 10px;
    overflow: hidden;
}

.table th {
    background-color: var(--primary);
    color: var(--white);
    padding: 12px 15px;
    text-align: left;
    font-weight: 500;
}

.table td {
    padding: 12px 15px;
    border-bottom: 1px solid #f0f0f0;
    vertical-align: middle;
}

.table tr:last-child td {
    border-bottom: none;
}

.table tr:hover td {
    background-color: rgba(67, 97, 238, 0.05);
}

.badge {
    display: inline-block;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 0.75rem;
    font-weight: 500;
}

.badge-success {
    background-color: rgba(76, 201, 240, 0.1);
    color: var(--success);
}

.badge-warning {
    background-color: rgba(248, 150, 30, 0.1);
    color: var(--warning);
}

.badge-danger {
    background-color: rgba(247, 37, 133, 0.1);
    color: var(--danger);
}

/* Subject Input Grid */
.subject-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 15px;
    margin-top: 15px;
}

.subject-input-group {
    background-color: #f8f9fa;
    border-radius: 8px;
    padding: 12px;
    transition: var(--transition);
}

.subject-input-group:hover {
    background-color: #f1f3f5;
}

.subject-input-group label {
    display: block;
    margin-bottom: 5px;
    font-size: 0.85rem;
    color: var(--gray);
}

/* House Test Options */
.house-test-options {
    display: flex;
    gap: 15px;
    margin-top: 10px;
}

.house-test-option {
    flex: 1;
    background-color: #f8f9fa;
    border-radius: 6px;
    padding: 10px;
    text-align: center;
    cursor: pointer;
    transition: var(--transition);
    border: 1px solid #e0e0e0;
}

.house-test-option:hover {
    background-color: #f1f3f5;
}

.house-test-option.selected {
    background-color: var(--primary);
    color: var(--white);
    border-color: var(--primary);
}

/* Animations */
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.fade-in {
    animation: fadeIn 0.3s ease forwards;
}

/* Toast Notification */
.toast-container {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 1100;
}

.toast {
    padding: 15px 20px;
    border-radius: 8px;
    color: var(--white);
    margin-bottom: 10px;
    display: flex;
    align-items: center;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    animation: fadeIn 0.3s ease;
    max-width: 350px;
}

.toast i {
    margin-right: 10px;
    font-size: 1.2rem;
}

.toast-success {
    background-color: var(--success);
}

.toast-error {
    background-color: var(--danger);
}

/* Modal Styles */
.modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 2000;
    opacity: 0;
    visibility: hidden;
    transition: var(--transition);
}

.modal.active {
    opacity: 1;
    visibility: visible;
}

.modal-content {
    background-color: var(--white);
    border-radius: 10px;
    width: 90%;
    max-width: 600px;
    max-height: 90vh;
    overflow-y: auto;
    transform: translateY(-20px);
    transition: var(--transition);
}

.modal.active .modal-content {
    transform: translateY(0);
}

.modal-header {
    padding: 15px 20px;
    border-bottom: 1px solid #eee;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.modal-header h3 {
    margin: 0;
    font-weight: 600;
}

.modal-body {
    padding: 20px;
}

.modal-footer {
    padding: 15px 20px;
    border-top: 1px solid #eee;
    display: flex;
    justify-content: flex-end;
    gap: 10px;
}

/* Responsive */
@media (max-width: 992px) {
    .sidebar {
        transform: translateX(-100%);
    }
    .sidebar.active {
        transform: translateX(0);
    }
    .main-content {
        margin-left: 0;
    }
    .menu-toggle {
        display: block;
    }
}

/* Custom Scrollbar */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: #f1f1f1;
}

::-webkit-scrollbar-thumb {
    background: var(--primary);
    border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--primary-dark);
}

/* ===== AUTH MODAL ===== */
.auth-modal-backdrop {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(8px);
    z-index: 1000;
    display: flex;
    justify-content: center;
    align-items: center;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
}

.auth-modal-backdrop.active {
    opacity: 1;
    visibility: visible;
}

.auth-modal {
    width: 100%;
    max-width: 420px;
    background: white;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
    transform: translateY(20px);
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.auth-modal-backdrop.active .auth-modal {
    transform: translateY(0);
}

.auth-header {
    padding: 24px;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    text-align: center;
}

.auth-header h3 {
    margin: 0;
    font-weight: 600;
    font-size: 1.5rem;
}

.auth-header p {
    margin: 8px 0 0;
    opacity: 0.9;
    font-size: 0.9rem;
}

.auth-tabs {
    display: flex;
    border-bottom: 1px solid #eee;
}

.auth-tab {
    flex: 1;
    padding: 16px;
    text-align: center;
    cursor: pointer;
    font-weight: 500;
    color: var(--gray);
    transition: all 0.2s ease;
    border-bottom: 3px solid transparent;
}

.auth-tab.active {
    color: var(--primary);
    border-bottom-color: var(--primary);
}

.auth-tab i {
    margin-right: 8px;
}

.auth-content {
    padding: 24px;
}

.auth-form {
    display: none;
}

.auth-form.active {
    display: block;
    animation: fadeIn 0.4s ease;
}

.auth-form .form-group {
    margin-bottom: 20px;
}

.auth-form .form-label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
    color: var(--dark);
}

.input-with-icon {
    position: relative;
}

.input-with-icon i {
    position: absolute;
    left: 16px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--gray);
}

.auth-form .form-control {
    width: 100%;
    padding: 12px 16px 12px 42px;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    font-size: 0.95rem;
    transition: var(--transition);
}

.auth-form .form-control:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
    outline: none;
}

.btn-block {
    display: block;
    width: 100%;
    padding: 14px;
    font-size: 1rem;
}

.auth-footer {
    margin-top: 20px;
    text-align: center;
    font-size: 0.9rem;
    color: var(--gray);
}

.auth-footer a {
    color: var(--primary);
    text-decoration: none;
    font-weight: 500;
}

.auth-footer a:hover {
    text-decoration: underline;
}

/* Profile Picture Styles */
.profile-picture-container {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 20px;
}

.profile-avatar {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 1.2rem;
    background-size: cover;
    background-position: center;
}

/* Readonly field styling */
.form-control[readonly] {
    background-color: #f8f9fa;
    border-color: #e9ecef;
    cursor: not-allowed;
}

/* Settings card layout */
.settings-card {
    height: 100%;
    display: flex;
    flex-direction: column;
}

.settings-card .card-body {
    flex: 1;
}

/* Stats Grid */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin: 20px 0;
}

.stat-card {
    background: white;
    border-radius: 10px;
    padding: 20px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    display: flex;
    align-items: center;
    gap: 15px;
}

.stat-icon {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    color: white;
}

.stat-icon.bg-primary { background-color: var(--primary); }
.stat-icon.bg-success { background-color: var(--success); }
.stat-icon.bg-warning { background-color: var(--warning); }
.stat-icon.bg-info { background-color: var(--info); }

.stat-info h3 {
    margin: 0;
    font-size: 1.5rem;
    font-weight: 600;
}

.stat-info p {
    margin: 5px 0 0;
    color: var(--gray);
    font-size: 0.9rem;
}

/* Recent Activity */
.recent-activity {
    margin-top: 30px;
}

.recent-activity h4 {
    margin-bottom: 15px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.activity-list {
    background: white;
    border-radius: 10px;
    padding: 15px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
}

.activity-item {
    display: flex;
    gap: 15px;
    padding: 10px 0;
    border-bottom: 1px solid #eee;
}

.activity-item:last-child {
    border-bottom: none;
}

.activity-icon {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: rgba(67, 97, 238, 0.1);
    color: var(--primary);
    display: flex;
    align-items: center;
    justify-content: center;
}

.activity-content {
    flex: 1;
}

.activity-content p {
    margin: 0;
}

.activity-time {
    color: var(--gray);
    font-size: 0.8rem;
    margin-top: 5px;
    display: block;
}

/* Quick Actions */
.quick-actions {
    margin-top: 30px;
}

.quick-actions h4 {
    margin-bottom: 15px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.action-buttons {
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
}

/* Additional marks types */
.marks-type-tabs {
    display: flex;
    border-bottom: 1px solid #eee;
    margin-bottom: 15px;
}

.marks-type-tab {
    padding: 10px 15px;
    cursor: pointer;
    border-bottom: 3px solid transparent;
    transition: all 0.2s ease;
}

.marks-type-tab.active {
    border-bottom-color: var(--primary);
    color: var(--primary);
    font-weight: 500;
}

.marks-type-content {
    display: none;
}

.marks-type-content.active {
    display: block;
}

/* Print styles */
@media print {
    body * {
        visibility: hidden;
    }
    .print-section, .print-section * {
        visibility: visible;
    }
    .print-section {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
    }
    .no-print {
        display: none !important;
    }
}

/* File upload styles */
.file-upload {
    position: relative;
    display: inline-block;
}

.file-upload-input {
    position: absolute;
    left: 0;
    top: 0;
    opacity: 0;
    width: 100%;
    height: 100%;
    cursor: pointer;
}

/* Chart container */
.chart-container {
    width: 100%;
    height: 300px;
    margin: 20px 0;
}

/* Print button */
.print-btn {
    margin-left: 10px;
}

.section-content {
    display: none;
}

.section-content.active {
    display: block;
    animation: fadeIn 0.3s ease forwards;
}
    </style>
</head>
<body>
    <!-- Auth Modal -->
    <div class="auth-modal-backdrop" id="authModal">
        <div class="auth-modal">
            <div class="auth-header">
                <h3>Welcome Back!</h3>
                <p>Manage student sessional marks with ease</p>
            </div>
            
            <div class="auth-tabs">
                <div class="auth-tab active" data-tab="login">
                    <i class="fas fa-sign-in-alt"></i> Login
                </div>
                <div class="auth-tab" data-tab="register">
                    <i class="fas fa-user-plus"></i> Register
                </div>
            </div>
            
            <div class="auth-content">
                <!-- Login Form -->
                <form class="auth-form active" id="loginForm">
                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <div class="input-with-icon">
                            <i class="fas fa-envelope"></i>
                            <input type="email" class="form-control" id="loginEmail" placeholder="your@email.com" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <div class="input-with-icon">
                            <i class="fas fa-lock"></i>
                            <input type="password" class="form-control" id="loginPassword" placeholder="••••••••" required>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary btn-block">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </button>
                    
                    <div class="auth-footer">
                        Don't have an account? <a href="#" class="switch-tab" data-tab="register">Sign up</a>
                    </div>
                </form>
                
                <!-- Register Form -->
                <form class="auth-form" id="registerForm">
                    <div class="form-group">
                        <label class="form-label">Full Name</label>
                        <div class="input-with-icon">
                            <i class="fas fa-user"></i>
                            <input type="text" class="form-control" id="registerName" placeholder="John Doe" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <div class="input-with-icon">
                            <i class="fas fa-envelope"></i>
                            <input type="email" class="form-control" id="registerEmail" placeholder="your@email.com" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Department</label>
                        <div class="input-with-icon">
                            <i class="fas fa-building"></i>
                            <select class="form-control" id="registerDepartment" required>
                                <option value="">Select Department</option>
                                <option value="Computer Science">Computer Science</option>
                                <option value="Electrical Engineering">Electrical Engineering</option>
                                <option value="Mechanical Engineering">Mechanical Engineering</option>
                                <option value="Civil Engineering">Civil Engineering</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <div class="input-with-icon">
                            <i class="fas fa-lock"></i>
                            <input type="password" class="form-control" id="registerPassword" placeholder="••••••••" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Confirm Password</label>
                        <div class="input-with-icon">
                            <i class="fas fa-lock"></i>
                            <input type="password" class="form-control" id="registerConfirmPassword" placeholder="••••••••" required>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary btn-block">
                        <i class="fas fa-user-plus"></i> Create Account
                    </button>
                    
                    <div class="auth-footer">
                        Already have an account? <a href="#" class="switch-tab" data-tab="login">Sign in</a>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2><i class="fas fa-chalkboard-teacher"></i> Sessional Info</h2>
            </div>
            <nav class="sidebar-menu">
                <a href="#" class="menu-item active" data-section="dashboard">
                    <i class="fas fa-tachometer-alt"></i> Dashboard
                </a>
                <a href="#" class="menu-item" data-section="students">
                    <i class="fas fa-user-graduate"></i> Students
                </a>
                <a href="#" class="menu-item" data-section="subjects">
                    <i class="fas fa-book"></i> Subjects
                </a>
                <a href="#" class="menu-item" data-section="reports">
                    <i class="fas fa-chart-bar"></i> Reports
                </a>
                <a href="#" class="menu-item" data-section="settings">
                    <i class="fas fa-cog"></i> Settings
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <div class="header">
                <div class="header-title">
                    <h1 id="pageTitle">Student Sessional Marks Management</h1>
                </div>
                <div class="header-actions">
                    <div class="notification-icon" id="notificationIcon">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge">3</span>
                        <div class="notification-dropdown" id="notificationDropdown">
                            <div class="notification-header">
                                <h4>Notifications</h4>
                                <a href="#">Mark all as read</a>
                            </div>
                            <div class="notification-list" id="notificationList">
                                <!-- Notifications will be added here -->
                            </div>
                        </div>
                    </div>
                    <div class="user-profile">
                        <div class="user-avatar" id="userAvatar">JD</div>
                        <div class="profile-dropdown" id="profileDropdown">
                            <div class="profile-header">
                                <div class="avatar-lg" id="profileAvatar">JD</div>
                                <div class="profile-info">
                                    <h4 id="profileName">John Doe</h4>
                                    <p id="profileEmail">john.doe@example.com</p>
                                </div>
                            </div>
                            <div class="profile-menu">
                                <a href="#"><i class="fas fa-user"></i> My Profile</a>
                                <a href="#"><i class="fas fa-cog"></i> Settings</a>
                                <a href="#"><i class="fas fa-question-circle"></i> Help</a>
                                <a href="#" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Logout</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard Section -->
            <div class="section-content active" id="dashboardSection">
                <div class="card fade-in">
                    <div class="card-header">
                        <h3><i class="fas fa-chalkboard"></i> Teacher Dashboard</h3>
                    </div>
                    <div class="card-body">
                        <div class="welcome-message">
                            <h4>Welcome back, <span id="teacherGreeting">Teacher</span>!</h4>
                            <p>Here's your daily overview of student sessional marks management.</p>
                        </div>
                        
                        <!-- Quick Stats -->
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-icon bg-primary">
                                    <i class="fas fa-user-graduate"></i>
                                </div>
                                <div class="stat-info">
                                    <h3 id="totalStudents">0</h3>
                                    <p>Total Students</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon bg-success">
                                    <i class="fas fa-book"></i>
                                </div>
                                <div class="stat-info">
                                    <h3 id="totalSubjects">0</h3>
                                    <p>Subjects</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon bg-warning">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <div class="stat-info">
                                    <h3 id="avgMarks">0%</h3>
                                    <p>Average Marks</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon bg-info">
                                    <i class="fas fa-bell"></i>
                                </div>
                                <div class="stat-info">
                                    <h3 id="unreadNotif">0</h3>
                                    <p>Notifications</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Recent Activity -->
                        <div class="recent-activity">
                            <h4><i class="fas fa-history"></i> Recent Activity</h4>
                            <div class="activity-list" id="activityList">
                                <!-- Activities will be added here -->
                            </div>
                        </div>
                        
                        <!-- Quick Actions -->
                        <div class="quick-actions">
                            <h4><i class="fas fa-bolt"></i> Quick Actions</h4>
                            <div class="action-buttons">
                                <button class="btn btn-primary" onclick="navigateToSection('students')">
                                    <i class="fas fa-plus"></i> Add Student Marks
                                </button>
                                <button class="btn btn-success" onclick="navigateToSection('reports')">
                                    <i class="fas fa-chart-pie"></i> Generate Report
                                </button>
                                <button class="btn btn-info" onclick="navigateToSection('subjects')">
                                    <i class="fas fa-book-medical"></i> Add Subject
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Students Section -->
            <div class="section-content" id="studentsSection">
                <!-- Student Management Card -->
                <div class="card fade-in">
                    <div class="card-header">
                        <h3><i class="fas fa-user-graduate"></i> Student Marks Management</h3>
                    </div>
                    <div class="card-body">
                        <form id="studentForm">
                            <div class="form-row">
                                <div class="form-col">
                                    <div class="form-group">
                                        <label class="form-label" for="studentRollNo">Roll Number</label>
                                        <input type="text" class="form-control" id="studentRollNo" placeholder="Enter roll number">
                                    </div>
                                </div>
                                <div class="form-col">
                                    <div class="form-group">
                                        <label class="form-label" for="studentName">Student Name</label>
                                        <input type="text" class="form-control" id="studentName" placeholder="Enter student name">
                                    </div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-col">
                                    <div class="form-group">
                                        <label class="form-label" for="studentDepartment">Department</label>
                                        <select class="form-control" id="studentDepartment">
                                            <option value="">Select Department</option>
                                            <option value="Computer Science">Computer Science</option>
                                            <option value="Electrical Engineering">Electrical Engineering</option>
                                            <option value="Mechanical Engineering">Mechanical Engineering</option>
                                            <option value="Civil Engineering">Civil Engineering</option>
                                            <option value="Business Administration">Business Administration</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-col">
                                    <div class="form-group">
                                        <label class="form-label" for="studentSemester">Semester</label>
                                        <select class="form-control" id="studentSemester">
                                            <option value="">Select Semester</option>
                                            <option value="1">1st Semester</option>
                                            <option value="2">2nd Semester</option>
                                            <option value="3">3rd Semester</option>
                                            <option value="4">4th Semester</option>
                                            <option value="5">5th Semester</option>
                                            <option value="6">6th Semester</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">House Test</label>
                                <div class="house-test-options">
                                    <div class="house-test-option" data-test="house1">House Test 1</div>
                                    <div class="house-test-option" data-test="house2">House Test 2</div>
                                    <div class="house-test-option" data-test="house3">House Test 3</div>
                                </div>
                                <input type="hidden" id="selectedHouseTest">
                            </div>

                            <!-- Marks Type Tabs -->
                            <div class="marks-type-tabs">
                                <div class="marks-type-tab active" data-marks-type="theory">Mst Theory</div>
                                <div class="marks-type-tab" data-marks-type="practical">Practical</div>
                                <div class="marks-type-tab" data-marks-type="assignment">Assignment</div>
                                <div class="marks-type-tab" data-marks-type="seminar">Seminar</div>
                            </div>

                            <!-- Theory Marks (Default) -->
                            <div class="marks-type-content active" id="theoryMarks">
                                <div class="form-group">
                                    <label class="form-label">Subject Marks (Max 6 subjects)</label>
                                    <div class="subject-grid">
                                        <div class="subject-input-group">
                                            <label>Subject 1</label>
                                            <input type="text" class="form-control mb-2" id="subject1" placeholder="Subject name">
                                            <input type="number" class="form-control" id="marks1" placeholder="Marks" min="0" max="100">
                                        </div>
                                        <div class="subject-input-group">
                                            <label>Subject 2</label>
                                            <input type="text" class="form-control mb-2" id="subject2" placeholder="Subject name">
                                            <input type="number" class="form-control" id="marks2" placeholder="Marks" min="0" max="100">
                                        </div>
                                        <div class="subject-input-group">
                                            <label>Subject 3</label>
                                            <input type="text" class="form-control mb-2" id="subject3" placeholder="Subject name">
                                            <input type="number" class="form-control" id="marks3" placeholder="Marks" min="0" max="100">
                                        </div>
                                        <div class="subject-input-group">
                                            <label>Subject 4</label>
                                            <input type="text" class="form-control mb-2" id="subject4" placeholder="Subject name">
                                            <input type="number" class="form-control" id="marks4" placeholder="Marks" min="0" max="100">
                                        </div>
                                        <div class="subject-input-group">
                                            <label>Subject 5</label>
                                            <input type="text" class="form-control mb-2" id="subject5" placeholder="Subject name">
                                            <input type="number" class="form-control" id="marks5" placeholder="Marks" min="0" max="100">
                                        </div>
                                        <div class="subject-input-group">
                                            <label>Subject 6</label>
                                            <input type="text" class="form-control mb-2" id="subject6" placeholder="Subject name">
                                            <input type="number" class="form-control" id="marks6" placeholder="Marks" min="0" max="100">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Practical Marks -->
                            <div class="marks-type-content" id="practicalMarks">
                                <div class="form-group">
                                    <label class="form-label">Practical Marks (Max 6 subjects)</label>
                                    <div class="subject-grid">
                                        <div class="subject-input-group">
                                            <label>Practical 1</label>
                                            <input type="text" class="form-control mb-2" id="practicalSubject1" placeholder="Practical name">
                                            <input type="number" class="form-control" id="practicalMarks1" placeholder="Marks" min="0" max="100">
                                        </div>
                                        <div class="subject-input-group">
                                            <label>Practical 2</label>
                                            <input type="text" class="form-control mb-2" id="practicalSubject2" placeholder="Practical name">
                                            <input type="number" class="form-control" id="practicalMarks2" placeholder="Marks" min="0" max="100">
                                        </div>
                                        <div class="subject-input-group">
                                            <label>Practical 3</label>
                                            <input type="text" class="form-control mb-2" id="practicalSubject3" placeholder="Practical name">
                                            <input type="number" class="form-control" id="practicalMarks3" placeholder="Marks" min="0" max="100">
                                        </div>
                                        <div class="subject-input-group">
                                            <label>Practical 4</label>
                                            <input type="text" class="form-control mb-2" id="practicalSubject4" placeholder="Practical name">
                                            <input type="number" class="form-control" id="practicalMarks4" placeholder="Marks" min="0" max="100">
                                        </div>
                                        <div class="subject-input-group">
                                            <label>Practical 5</label>
                                            <input type="text" class="form-control mb-2" id="practicalSubject5" placeholder="Practical name">
                                            <input type="number" class="form-control" id="practicalMarks5" placeholder="Marks" min="0" max="100">
                                        </div>
                                        <div class="subject-input-group">
                                            <label>Practical 6</label>
                                            <input type="text" class="form-control mb-2" id="practicalSubject6" placeholder="Practical name">
                                            <input type="number" class="form-control" id="practicalMarks6" placeholder="Marks" min="0" max="100">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Assignment Marks -->
                            <div class="marks-type-content" id="assignmentMarks">
                                <div class="form-group">
                                    <label class="form-label">Assignment Marks (Max 6 subjects)</label>
                                    <div class="subject-grid">
                                        <div class="subject-input-group">
                                            <label>Assignment 1</label>
                                            <input type="text" class="form-control mb-2" id="assignmentSubject1" placeholder="Assignment name">
                                            <input type="number" class="form-control" id="assignmentMarks1" placeholder="Marks" min="0" max="100">
                                        </div>
                                        <div class="subject-input-group">
                                            <label>Assignment 2</label>
                                            <input type="text" class="form-control mb-2" id="assignmentSubject2" placeholder="Assignment name">
                                            <input type="number" class="form-control" id="assignmentMarks2" placeholder="Marks" min="0" max="100">
                                        </div>
                                        <div class="subject-input-group">
                                            <label>Assignment 3</label>
                                            <input type="text" class="form-control mb-2" id="assignmentSubject3" placeholder="Assignment name">
                                            <input type="number" class="form-control" id="assignmentMarks3" placeholder="Marks" min="0" max="100">
                                        </div>
                                        <div class="subject-input-group">
                                            <label>Assignment 4</label>
                                            <input type="text" class="form-control mb-2" id="assignmentSubject4" placeholder="Assignment name">
                                            <input type="number" class="form-control" id="assignmentMarks4" placeholder="Marks" min="0" max="100">
                                        </div>
                                        <div class="subject-input-group">
                                            <label>Assignment 5</label>
                                            <input type="text" class="form-control mb-2" id="assignmentSubject5" placeholder="Assignment name">
                                            <input type="number" class="form-control" id="assignmentMarks5" placeholder="Marks" min="0" max="100">
                                        </div>
                                        <div class="subject-input-group">
                                            <label>Assignment 6</label>
                                            <input type="text" class="form-control mb-2" id="assignmentSubject6" placeholder="Assignment name">
                                            <input type="number" class="form-control" id="assignmentMarks6" placeholder="Marks" min="0" max="100">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Seminar Marks -->
                            <div class="marks-type-content" id="seminarMarks">
                                <div class="form-group">
                                    <label class="form-label">Seminar Marks (Max 6 subjects)</label>
                                    <div class="subject-grid">
                                        <div class="subject-input-group">
                                            <label>Seminar 1</label>
                                            <input type="text" class="form-control mb-2" id="seminarSubject1" placeholder="Seminar topic">
                                            <input type="number" class="form-control" id="seminarMarks1" placeholder="Marks" min="0" max="100">
                                        </div>
                                        <div class="subject-input-group">
                                            <label>Seminar 2</label>
                                            <input type="text" class="form-control mb-2" id="seminarSubject2" placeholder="Seminar topic">
                                            <input type="number" class="form-control" id="seminarMarks2" placeholder="Marks" min="0" max="100">
                                        </div>
                                        <div class="subject-input-group">
                                            <label>Seminar 3</label>
                                            <input type="text" class="form-control mb-2" id="seminarSubject3" placeholder="Seminar topic">
                                            <input type="number" class="form-control" id="seminarMarks3" placeholder="Marks" min="0" max="100">
                                        </div>
                                        <div class="subject-input-group">
                                            <label>Seminar 4</label>
                                            <input type="text" class="form-control mb-2" id="seminarSubject4" placeholder="Seminar topic">
                                            <input type="number" class="form-control" id="seminarMarks4" placeholder="Marks" min="0" max="100">
                                        </div>
                                        <div class="subject-input-group">
                                            <label>Seminar 5</label>
                                            <input type="text" class="form-control mb-2" id="seminarSubject5" placeholder="Seminar topic">
                                            <input type="number" class="form-control" id="seminarMarks5" placeholder="Marks" min="0" max="100">
                                        </div>
                                        <div class="subject-input-group">
                                            <label>Seminar 6</label>
                                            <input type="text" class="form-control mb-2" id="seminarSubject6" placeholder="Seminar topic">
                                            <input type="number" class="form-control" id="seminarMarks6" placeholder="Marks" min="0" max="100">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-plus"></i> Add Student
                                </button>
                                <button type="button" class="btn btn-success" id="saveAllData">
                                    <i class="fas fa-save"></i> Save All Data
                                </button>
                                <button type="button" class="btn btn-warning" id="clearForm">
                                    <i class="fas fa-eraser"></i> Clear Form
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Student Records Card -->
                <div class="card fade-in">
                    <div class="card-header">
                        <h3><i class="fas fa-table"></i> Student Records</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <div class="form-row">
                                <div class="form-col">
                                    <label class="form-label">Filter by Department</label>
                                    <select class="form-control" id="filterDepartment">
                                        <option value="">All Departments</option>
                                        <option value="Computer Science">Computer Science</option>
                                        <option value="Electrical Engineering">Electrical Engineering</option>
                                        <option value="Mechanical Engineering">Mechanical Engineering</option>
                                        <option value="Civil Engineering">Civil Engineering</option>
                                        <option value="Business Administration">Business Administration</option>
                                    </select>
                                </div>
                                <div class="form-col">
                                    <label class="form-label">Filter by Semester</label>
                                    <select class="form-control" id="filterSemester">
                                        <option value="">All Semesters</option>
                                        <option value="1">1st Semester</option>
                                        <option value="2">2nd Semester</option>
                                        <option value="3">3rd Semester</option>
                                        <option value="4">4th Semester</option>
                                        <option value="5">5th Semester</option>
                                        <option value="6">6th Semester</option>
                                    </select>
                                </div>
                                <div class="form-col">
                                    <label class="form-label">Filter by House Test</label>
                                    <select class="form-control" id="filterHouseTest">
                                        <option value="">All Tests</option>
                                        <option value="house1">House Test 1</option>
                                        <option value="house2">House Test 2</option>
                                        <option value="house3">House Test 3</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="table-responsive">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Roll No</th>
                                        <th>Name</th>
                                        <th>Department</th>
                                        <th>Semester</th>
                                        <th>House Test</th>
                                        <th>Subjects</th>
                                        <th>Marks</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="studentsTableBody">
                                    <!-- Student data will be inserted here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Subjects Section -->
            <div class="section-content" id="subjectsSection">
                <div class="card fade-in">
                    <div class="card-header">
                        <h3><i class="fas fa-book"></i> Subject Management</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <p>Manage the subjects for each department and semester. You can add, edit, or remove subjects from the system.</p>
                        </div>
                        <div class="form-row">
                            <div class="form-col">
                                <div class="card">
                                    <div class="card-header">
                                        <h3><i class="fas fa-plus-circle"></i> Add New Subject</h3>
                                    </div>
                                    <div class="card-body">
                                        <form id="subjectForm">
                                            <div class="form-group">
                                                <label class="form-label" for="subjectName">Subject Name</label>
                                                <input type="text" class="form-control" id="subjectName" placeholder="Enter subject name">
                                            </div>
                                            <div class="form-row">
                                                <div class="form-col">
                                                    <div class="form-group">
                                                        <label class="form-label" for="subjectDepartment">Department</label>
                                                        <select class="form-control" id="subjectDepartment">
                                                            <option value="">Select Department</option>
                                                            <option value="Computer Science">Computer Science</option>
                                                            <option value="Electrical Engineering">Electrical Engineering</option>
                                                            <option value="Mechanical Engineering">Mechanical Engineering</option>
                                                            <option value="Civil Engineering">Civil Engineering</option>
                                                            <option value="Business Administration">Business Administration</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="form-col">
                                                    <div class="form-group">
                                                        <label class="form-label" for="subjectSemester">Semester</label>
                                                        <select class="form-control" id="subjectSemester">
                                                            <option value="">Select Semester</option>
                                                            <option value="1">1st Semester</option>
                                                            <option value="2">2nd Semester</option>
                                                            <option value="3">3rd Semester</option>
                                                            <option value="4">4th Semester</option>
                                                            <option value="5">5th Semester</option>
                                                            <option value="6">6th Semester</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <button type="submit" class="btn btn-primary">
                                                <i class="fas fa-plus"></i> Add Subject
                                            </button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            <div class="form-col">
                                <div class="card">
                                    <div class="card-header">
                                        <h3><i class="fas fa-list"></i> Subject List</h3>
                                    </div>
                                    <div class="card-body">
                                        <div class="form-group">
                                            <div class="form-row">
                                                <div class="form-col">
                                                    <label class="form-label">Filter by Department</label>
                                                    <select class="form-control" id="subjectFilterDepartment">
                                                        <option value="">All Departments</option>
                                                        <option value="Computer Science">Computer Science</option>
                                                        <option value="Electrical Engineering">Electrical Engineering</option>
                                                        <option value="Mechanical Engineering">Mechanical Engineering</option>
                                                        <option value="Civil Engineering">Civil Engineering</option>
                                                        <option value="Business Administration">Business Administration</option>
                                                    </select>
                                                </div>
                                                <div class="form-col">
                                                    <label class="form-label">Filter by Semester</label>
                                                    <select class="form-control" id="subjectFilterSemester">
                                                        <option value="">All Semesters</option>
                                                        <option value="1">1st Semester</option>
                                                        <option value="2">2nd Semester</option>
                                                        <option value="3">3rd Semester</option>
                                                        <option value="4">4th Semester</option>
                                                        <option value="5">5th Semester</option>
                                                        <option value="6">6th Semester</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="table-responsive">
                                            <table class="table">
                                                <thead>
                                                    <tr>
                                                        <th>Subject Name</th>
                                                        <th>Department</th>
                                                        <th>Semester</th>
                                                        <th>Actions</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="subjectsTableBody">
                                                    <!-- Subjects will be inserted here -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Reports Section -->
            <div class="section-content" id="reportsSection">
                <div class="card fade-in">
                    <div class="card-header">
                        <h3><i class="fas fa-chart-bar"></i> Reports</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <p>Generate various reports based on student performance, attendance, and other metrics.</p>
                        </div>
                        <div class="form-row">
                            <div class="form-col">
                                <div class="card">
                                    <div class="card-header">
                                        <h3><i class="fas fa-chart-pie"></i> Performance Reports</h3>
                                    </div>
                                    <div class="card-body">
                                        <div class="form-group">
                                            <label class="form-label">Select Report Type</label>
                                            <select class="form-control" id="reportType">
                                                <option value="">Select a report</option>
                                                <option value="department">Department-wise Performance</option>
                                                <option value="semester">Semester-wise Performance</option>
                                                <option value="subject">Subject-wise Performance</option>
                                                <option value="housetest">House Test Comparison</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <button class="btn btn-primary" id="generateReport">
                                                <i class="fas fa-chart-line"></i> Generate Report
                                            </button>
                                        </div>
                                        <div id="reportResults">
                                            <!-- Report results will be displayed here -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-col">
                                <div class="card">
                                    <div class="card-header">
                                        <h3><i class="fas fa-file-export"></i> Export Data</h3>
                                    </div>
                                    <div class="card-body">
                                        <div class="form-group">
                                            <label class="form-label">Select Data to Export</label>
                                            <select class="form-control" id="exportType">
                                                <option value="">Select data type</option>
                                                <option value="students">Student Records</option>
                                                <option value="marks">Marks Data</option>
                                                <option value="subjects">Subject List</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Select Format</label>
                                            <div class="form-row">
                                                <div class="form-col">
                                                    <button class="btn btn-success" id="exportExcel">
                                                        <i class="fas fa-file-excel"></i> Excel
                                                    </button>
                                                </div>
                                                <div class="form-col">
                                                    <button class="btn btn-primary" id="exportPDF">
                                                        <i class="fas fa-file-pdf"></i> PDF
                                                    </button>
                                                    <button class="btn btn-secondary print-btn" id="printReport">
                                                        <i class="fas fa-print"></i> Print
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Section -->
            <div class="section-content" id="settingsSection">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-cog"></i> Account Settings</h3>
                    </div>
                    <div class="card-body">
                        <form id="settingsForm">
                            <div class="form-row">
                                <div class="form-col">
                                    <div class="card">
                                        <div class="card-header">
                                            <h3><i class="fas fa-user"></i> Profile Information</h3>
                                        </div>
                                        <div class="card-body">
                                            <div class="form-group">
                                                <label class="form-label">Profile Picture</label>
                                                <div class="profile-picture-container">
                                                    <div class="profile-avatar" id="settingsAvatar">JD</div>
                                                    <div class="file-upload">
                                                        <button type="button" class="btn btn-outline-primary btn-sm">
                                                            <i class="fas fa-camera"></i> Change
                                                        </button>
                                                        <input type="file" class="file-upload-input" id="profilePictureUpload" accept="image/*">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label" for="settingsName">Full Name</label>
                                                <input type="text" class="form-control" id="settingsName" required>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label" for="settingsEmail">Email</label>
                                                <input type="email" class="form-control" id="settingsEmail" required>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label" for="settingsDepartment">Department</label>
                                                <input type="text" class="form-control" id="settingsDepartment" readonly>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label" for="settingsPhone">Phone Number</label>
                                                <input type="tel" class="form-control" id="settingsPhone">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-col">
                                    <div class="card">
                                        <div class="card-header">
                                            <h3><i class="fas fa-lock"></i> Security</h3>
                                        </div>
                                        <div class="card-body">
                                            <div class="form-group">
                                                <label class="form-label" for="currentPassword">Current Password</label>
                                                <input type="password" class="form-control" id="currentPassword">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label" for="newPassword">New Password</label>
                                                <input type="password" class="form-control" id="newPassword">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label" for="confirmPassword">Confirm Password</label>
                                                <input type="password" class="form-control" id="confirmPassword">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Last Login</label>
                                                <input type="text" class="form-control" id="lastLogin" readonly>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Account Created</label>
                                                <input type="text" class="form-control" id="accountCreated" readonly>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group text-right">
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Save Changes
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Toast Notification Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Profile Modal -->
    <div class="modal" id="profileModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-user"></i> Teacher Profile</h3>
                <button class="btn btn-danger btn-sm" id="closeProfileModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <div class="form-row">
                        <div class="form-col">
                            <div class="user-avatar" style="width: 80px; height: 80px; font-size: 1.8rem;" id="modalAvatar">JD</div>
                        </div>
                        <div class="form-col">
                            <h4 id="modalName">John Doe</h4>
                            <p id="modalEmail">john.doe@example.com</p>
                            <p id="modalDepartment">Computer Science Department</p>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <h4>Contact Information</h4>
                    <p><strong>Email:</strong> <span id="modalContactEmail">john.doe@example.com</span></p>
                    <p><strong>Phone:</strong> <span id="modalPhone">+1 234 567 8901</span></p>
                </div>
                <div class="form-group">
                    <h4>System Information</h4>
                    <p><strong>Last Login:</strong> <span id="modalLastLogin">Today at 10:30 AM</span></p>
                    <p><strong>Account Created:</strong> <span id="modalAccountCreated">January 15, 2023</span></p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="editProfileBtn">
                    <i class="fas fa-edit"></i> Edit Profile
                </button>
            </div>
        </div>
    </div>

    <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script>
// Global variables
let currentUser = null;
let users = [];
let students = [];
let subjects = [];
let notifications = [
    { id: 1, title: "New Student Added", message: "A new student record was added to the system", time: "10 mins ago", read: false },
    { id: 2, title: "System Update", message: "A new version of the system is available", time: "2 hours ago", read: false },
    { id: 3, title: "Marks Deadline", message: "Reminder: House Test 1 marks submission deadline is tomorrow", time: "1 day ago", read: true }
];
let currentSection = 'dashboard';
let currentMarksType = 'theory';

// DOM elements
const authModal = document.getElementById('authModal');
const loginForm = document.getElementById('loginForm');
const registerForm = document.getElementById('registerForm');
const authTabs = document.querySelectorAll('.auth-tab');
const switchTabLinks = document.querySelectorAll('.switch-tab');
const studentForm = document.getElementById('studentForm');
const subjectForm = document.getElementById('subjectForm');
const settingsForm = document.getElementById('settingsForm');
const saveAllDataBtn = document.getElementById('saveAllData');
const clearFormBtn = document.getElementById('clearForm');
const studentsTableBody = document.getElementById('studentsTableBody');
const subjectsTableBody = document.getElementById('subjectsTableBody');
const userAvatar = document.getElementById('userAvatar');
const profileAvatar = document.getElementById('profileAvatar');
const profileName = document.getElementById('profileName');
const profileEmail = document.getElementById('profileEmail');
const profileDropdown = document.getElementById('profileDropdown');
const notificationIcon = document.getElementById('notificationIcon');
const notificationDropdown = document.getElementById('notificationDropdown');
const notificationList = document.getElementById('notificationList');
const toastContainer = document.getElementById('toastContainer');
const menuItems = document.querySelectorAll('.menu-item');
const sectionContents = document.querySelectorAll('.section-content');
const pageTitle = document.getElementById('pageTitle');
const profileModal = document.getElementById('profileModal');
const closeProfileModal = document.getElementById('closeProfileModal');
const editProfileBtn = document.getElementById('editProfileBtn');
const modalAvatar = document.getElementById('modalAvatar');
const modalName = document.getElementById('modalName');
const modalEmail = document.getElementById('modalEmail');
const modalDepartment = document.getElementById('modalDepartment');
const modalContactEmail = document.getElementById('modalContactEmail');
const modalPhone = document.getElementById('modalPhone');
const modalLastLogin = document.getElementById('modalLastLogin');
const modalAccountCreated = document.getElementById('modalAccountCreated');
const houseTestOptions = document.querySelectorAll('.house-test-option');
const selectedHouseTest = document.getElementById('selectedHouseTest');
const filterDepartment = document.getElementById('filterDepartment');
const filterSemester = document.getElementById('filterSemester');
const filterHouseTest = document.getElementById('filterHouseTest');
const subjectFilterDepartment = document.getElementById('subjectFilterDepartment');
const subjectFilterSemester = document.getElementById('subjectFilterSemester');
const generateReportBtn = document.getElementById('generateReport');
const reportResults = document.getElementById('reportResults');
const exportExcelBtn = document.getElementById('exportExcel');
const exportPDFBtn = document.getElementById('exportPDF');
const printReportBtn = document.getElementById('printReport');
const logoutBtn = document.getElementById('logoutBtn');
const settingsName = document.getElementById('settingsName');
const settingsEmail = document.getElementById('settingsEmail');
const settingsDepartment = document.getElementById('settingsDepartment');
const settingsPhone = document.getElementById('settingsPhone');
const lastLogin = document.getElementById('lastLogin');
const accountCreated = document.getElementById('accountCreated');
const teacherGreeting = document.getElementById('teacherGreeting');
const profilePictureUpload = document.getElementById('profilePictureUpload');
const settingsAvatar = document.getElementById('settingsAvatar');
const marksTypeTabs = document.querySelectorAll('.marks-type-tab');
const marksTypeContents = document.querySelectorAll('.marks-type-content');

function initApp() {
    loadData();
    setupEventListeners();
    renderNotifications();
    updateUnreadCount();
    updateDashboardStats();
    
    // Check if user is logged in
    const savedUser = localStorage.getItem('currentUser');
    if (savedUser) {
        currentUser = JSON.parse(savedUser);
        hideAuthModal();
        updateProfileSection();
    } else {
        showAuthModal();
    }
}

// Load saved data from localStorage
function loadData() {
    const savedUsers = localStorage.getItem('users');
    const savedStudents = localStorage.getItem('studentData');
    const savedSubjects = localStorage.getItem('subjectData');
    
    if (savedUsers) {
        users = JSON.parse(savedUsers);
    }
    
    if (savedStudents) {
        students = JSON.parse(savedStudents);
        renderStudentsTable();
    }

    if (savedSubjects) {
        subjects = JSON.parse(savedSubjects);
        renderSubjectsTable();
    }

    // Set default subjects if none exist
    if (subjects.length === 0) {
        subjects = [
            { name: "Mathematics", department: "Computer Science", semester: "1" },
            { name: "Programming Fundamentals", department: "Computer Science", semester: "1" },
            { name: "Digital Logic Design", department: "Computer Science", semester: "1" },
            { name: "Data Structures", department: "Computer Science", semester: "2" },
            { name: "Database Systems", department: "Computer Science", semester: "3" },
            { name: "Computer Networks", department: "Computer Science", semester: "4" },
            { name: "Software Engineering", department: "Computer Science", semester: "5" },
            { name: "Artificial Intelligence", department: "Computer Science", semester: "6" }
        ];
        localStorage.setItem('subjectData', JSON.stringify(subjects));
    }
}

// Set up event listeners
function setupEventListeners() {
    // Auth modal tabs
    authTabs.forEach(tab => {
        tab.addEventListener('click', () => {
            const tabName = tab.dataset.tab;
            switchAuthTab(tabName);
        });
    });

    // Switch between login/register
    switchTabLinks.forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            const tabName = link.dataset.tab;
            switchAuthTab(tabName);
        });
    });

    // Login form
    loginForm.addEventListener('submit', handleLogin);

    // Register form
    registerForm.addEventListener('submit', handleRegister);

    // Student form
    studentForm.addEventListener('submit', addStudent);

    // Subject form
    subjectForm.addEventListener('submit', addSubject);

    // Settings form
    settingsForm.addEventListener('submit', saveSettings);

    // Buttons
    saveAllDataBtn.addEventListener('click', saveAllStudentData);
    clearFormBtn.addEventListener('click', clearStudentForm);
    generateReportBtn.addEventListener('click', generateReport);
    exportExcelBtn.addEventListener('click', exportToExcel);
    exportPDFBtn.addEventListener('click', exportToPDF);
    printReportBtn.addEventListener('click', printReport);
    logoutBtn.addEventListener('click', logout);

    // Profile dropdown
    userAvatar.addEventListener('click', toggleProfileDropdown);
    editProfileBtn.addEventListener('click', editProfile);

    // Notifications
    notificationIcon.addEventListener('click', toggleNotificationDropdown);

    // Navigation menu
    menuItems.forEach(item => {
        item.addEventListener('click', (e) => {
            e.preventDefault();
            navigateToSection(item.dataset.section);
        });
    });

    // Close modal
    closeProfileModal.addEventListener('click', () => {
        profileModal.classList.remove('active');
    });

    // House test options
    houseTestOptions.forEach(option => {
        option.addEventListener('click', () => {
            houseTestOptions.forEach(opt => opt.classList.remove('selected'));
            option.classList.add('selected');
            selectedHouseTest.value = option.dataset.test;
        });
    });

    // Filters
    filterDepartment.addEventListener('change', filterStudents);
    filterSemester.addEventListener('change', filterStudents);
    filterHouseTest.addEventListener('change', filterStudents);
    subjectFilterDepartment.addEventListener('change', filterSubjects);
    subjectFilterSemester.addEventListener('change', filterSubjects);

    // Profile picture upload
    profilePictureUpload.addEventListener('change', handleProfilePictureUpload);

    // Marks type tabs
    marksTypeTabs.forEach(tab => {
        tab.addEventListener('click', () => {
            const marksType = tab.dataset.marksType;
            switchMarksType(marksType);
        });
    });
}

// Switch between marks types (theory, practical, etc.)
function switchMarksType(type) {
    currentMarksType = type;
    
    // Update active tab
    marksTypeTabs.forEach(tab => {
        tab.classList.toggle('active', tab.dataset.marksType === type);
    });
    
    // Show corresponding content
    marksTypeContents.forEach(content => {
        content.classList.toggle('active', content.id === `${type}Marks`);
    });
}

// Handle profile picture upload
function handleProfilePictureUpload(e) {
    const file = e.target.files[0];
    if (!file) return;
    
    if (!file.type.match('image.*')) {
        showToast('Please select an image file', 'error');
        return;
    }
    
    const reader = new FileReader();
    reader.onload = function(event) {
        // Update all avatar displays
        const avatarElements = [userAvatar, profileAvatar, modalAvatar, settingsAvatar];
        avatarElements.forEach(el => {
            el.style.backgroundImage = `url(${event.target.result})`;
            el.textContent = ''; // Remove initials
        });
        
        // Save to current user
        if (currentUser) {
            currentUser.profilePicture = event.target.result;
            updateUserInStorage(currentUser);
        }
        
        showToast('Profile picture updated successfully!');
    };
    reader.readAsDataURL(file);
}

// Switch between login/register tabs
function switchAuthTab(tabName) {
    authTabs.forEach(tab => {
        tab.classList.toggle('active', tab.dataset.tab === tabName);
    });

    document.querySelectorAll('.auth-form').forEach(form => {
        form.classList.toggle('active', form.id === `${tabName}Form`);
    });
}

// Show auth modal
function showAuthModal() {
    authModal.classList.add('active');
    document.body.style.overflow = 'hidden';
}

// Hide auth modal
function hideAuthModal() {
    authModal.classList.remove('active');
    document.body.style.overflow = '';
}

// Handle login
function handleLogin(e) {
    e.preventDefault();
    
    const email = document.getElementById('loginEmail').value;
    const password = document.getElementById('loginPassword').value;
    
    // Find user
    const user = users.find(u => u.email === email && u.password === password);
    
    if (user) {
        currentUser = user;
        localStorage.setItem('currentUser', JSON.stringify(user));
        
        // Update last login
        currentUser.lastLogin = new Date().toISOString();
        updateUserInStorage(currentUser);
        
        hideAuthModal();
        updateProfileSection();
        showToast('Login successful! Welcome back!');
    } else {
        showToast('Invalid email or password', 'error');
    }
}

// Handle registration
function handleRegister(e) {
    e.preventDefault();
    
    const name = document.getElementById('registerName').value;
    const email = document.getElementById('registerEmail').value;
    const department = document.getElementById('registerDepartment').value;
    const password = document.getElementById('registerPassword').value;
    const confirmPassword = document.getElementById('registerConfirmPassword').value;
    
    // Validation
    if (password !== confirmPassword) {
        showToast('Passwords do not match', 'error');
        return;
    }
    
    // Check if user exists
    if (users.some(u => u.email === email)) {
        showToast('Email already registered', 'error');
        return;
    }
    
    // Create new user
    const newUser = {
        id: Date.now().toString(),
        name,
        email,
        department,
        password,
        phone: '',
        createdAt: new Date().toISOString(),
        lastLogin: new Date().toISOString()
    };
    
    // Save user
    users.push(newUser);
    localStorage.setItem('users', JSON.stringify(users));
    currentUser = newUser;
    localStorage.setItem('currentUser', JSON.stringify(newUser));
    
    // Clear form
    registerForm.reset();
    
    // Switch to login tab
    switchAuthTab('login');
    
    showToast('Registration successful! Please login.');
}

// Update user in storage
function updateUserInStorage(updatedUser) {
    const userIndex = users.findIndex(u => u.id === updatedUser.id);
    if (userIndex !== -1) {
        users[userIndex] = updatedUser;
        localStorage.setItem('users', JSON.stringify(users));
        localStorage.setItem('currentUser', JSON.stringify(updatedUser));
    }
}

// Update profile section
function updateProfileSection() {
    if (!currentUser) return;
    
    // Update profile display
    const initials = currentUser.name.split(' ').map(n => n[0]).join('').toUpperCase();
    
    // Set avatar - use profile picture if available, otherwise initials
    const avatarElements = [userAvatar, profileAvatar, modalAvatar, settingsAvatar];
    avatarElements.forEach(el => {
        if (currentUser.profilePicture) {
            el.style.backgroundImage = `url(${currentUser.profilePicture})`;
            el.textContent = '';
        } else {
            el.style.backgroundImage = '';
            el.textContent = initials.substring(0, 2);
        }
    });
    
    profileName.textContent = currentUser.name;
    profileEmail.textContent = currentUser.email;
    
    // Update settings form fields
    settingsName.value = currentUser.name;
    settingsEmail.value = currentUser.email;
    settingsDepartment.value = currentUser.department || '';
    settingsPhone.value = currentUser.phone || '';
    lastLogin.value = new Date(currentUser.lastLogin).toLocaleString();
    accountCreated.value = new Date(currentUser.createdAt).toLocaleDateString();
    
    // Update greeting
    teacherGreeting.textContent = currentUser.name.split(' ')[0];
    
    // Update modal profile view
    modalName.textContent = currentUser.name;
    modalEmail.textContent = currentUser.email;
    modalDepartment.textContent = currentUser.department ? `${currentUser.department} Department` : 'Department not specified';
    modalContactEmail.textContent = currentUser.email;
    modalPhone.textContent = currentUser.phone || 'Not provided';
    modalLastLogin.textContent = new Date(currentUser.lastLogin).toLocaleString();
    modalAccountCreated.textContent = new Date(currentUser.createdAt).toLocaleDateString();
}

// Add new student
function addStudent(e) {
    e.preventDefault();
    
    // Validate required fields
    const rollNo = document.getElementById('studentRollNo').value;
    const name = document.getElementById('studentName').value;
    const department = document.getElementById('studentDepartment').value;
    const semester = document.getElementById('studentSemester').value;
    const houseTest = selectedHouseTest.value;
    
    if (!rollNo || !name || !department || !semester || !houseTest) {
        showToast('Please fill all required fields', 'error');
        return;
    }
    
    // Collect subject data based on current marks type
    const studentSubjects = [];
    const marks = [];
    const practicals = [];
    const practicalMarks = [];
    const assignments = [];
    const assignmentMarks = [];
    const seminars = [];
    const seminarMarks = [];
    
    // Get theory marks
    for (let i = 1; i <= 6; i++) {
        const subject = document.getElementById(`subject${i}`).value;
        const mark = document.getElementById(`marks${i}`).value;
        
        if (subject && mark) {
            studentSubjects.push(subject);
            marks.push(parseInt(mark));
        }
    }
    
    // Get practical marks
    for (let i = 1; i <= 6; i++) {
        const practical = document.getElementById(`practicalSubject${i}`).value;
        const practicalMark = document.getElementById(`practicalMarks${i}`).value;
        
        if (practical && practicalMark) {
            practicals.push(practical);
            practicalMarks.push(parseInt(practicalMark));
        }
    }
    
    // Get assignment marks
    for (let i = 1; i <= 6; i++) {
        const assignment = document.getElementById(`assignmentSubject${i}`).value;
        const assignmentMark = document.getElementById(`assignmentMarks${i}`).value;
        
        if (assignment && assignmentMark) {
            assignments.push(assignment);
            assignmentMarks.push(parseInt(assignmentMark));
        }
    }
    
    // Get seminar marks
    for (let i = 1; i <= 6; i++) {
        const seminar = document.getElementById(`seminarSubject${i}`).value;
        const seminarMark = document.getElementById(`seminarMarks${i}`).value;
        
        if (seminar && seminarMark) {
            seminars.push(seminar);
            seminarMarks.push(parseInt(seminarMark));
        }
    }
    
    if (studentSubjects.length === 0 && practicals.length === 0 && assignments.length === 0 && seminars.length === 0) {
        showToast('Please add at least one subject with marks', 'error');
        return;
    }
    
    const student = {
        rollNo,
        name,
        department,
        semester,
        houseTest,
        subjects: studentSubjects,
        marks,
        practicals,
        practicalMarks,
        assignments,
        assignmentMarks,
        seminars,
        seminarMarks,
        addedDate: new Date().toISOString()
    };
    
    students.push(student);
    renderStudentsTable();
    clearStudentForm();
    
    // Add notification
    const notification = {
        id: Date.now(),
        title: "New Student Added",
        message: `Added ${name} (${rollNo}) to ${department}`,
        time: "Just now",
        read: false
    };
    notifications.unshift(notification);
    renderNotifications();
    updateUnreadCount();
    
    showToast('Student record added successfully!');
}

// Render students table (updated to show all marks types)
function renderStudentsTable() {
    studentsTableBody.innerHTML = '';
    
    if (students.length === 0) {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td colspan="8" style="text-align: center; color: var(--gray);">
                No student records found. Add some students to get started.
            </td>
        `;
        studentsTableBody.appendChild(row);
        return;
    }
    
    students.forEach((student, index) => {
        const row = document.createElement('tr');
        
        // Create cells for each property
        row.innerHTML = `
            <td>${student.rollNo}</td>
            <td>${student.name}</td>
            <td>${student.department}</td>
            <td>${student.semester ? student.semester + ' Semester' : '-'}</td>
            <td>${student.houseTest ? student.houseTest.replace('house', 'House Test ') : '-'}</td>
            <td>
                ${student.subjects.length > 0 ? student.subjects.join(', ') : '-'}
                ${student.practicals.length > 0 ? '<br>Practicals: ' + student.practicals.join(', ') : ''}
                ${student.assignments.length > 0 ? '<br>Assignments: ' + student.assignments.join(', ') : ''}
                ${student.seminars.length > 0 ? '<br>Seminars: ' + student.seminars.join(', ') : ''}
            </td>
            <td>
                ${student.marks.map((mark, i) => 
                    `<span class="badge ${mark >= 80 ? 'badge-success' : mark >= 50 ? 'badge-warning' : 'badge-danger'}">
                        Theory: ${mark}
                    </span>`
                ).join(' ')}
                ${student.practicalMarks.map((mark, i) => 
                    `<span class="badge ${mark >= 80 ? 'badge-success' : mark >= 50 ? 'badge-warning' : 'badge-danger'}">
                        Practical: ${mark}
                    </span>`
                ).join(' ')}
                ${student.assignmentMarks.map((mark, i) => 
                    `<span class="badge ${mark >= 80 ? 'badge-success' : mark >= 50 ? 'badge-warning' : 'badge-danger'}">
                        Assignment: ${mark}
                    </span>`
                ).join(' ')}
                ${student.seminarMarks.map((mark, i) => 
                    `<span class="badge ${mark >= 80 ? 'badge-success' : mark >= 50 ? 'badge-warning' : 'badge-danger'}">
                        Seminar: ${mark}
                    </span>`
                ).join(' ')}
            </td>
            <td>
                <button class="btn btn-primary btn-sm" onclick="editStudent(${index})">
                    <i class="fas fa-edit"></i> Edit
                </button>
                <button class="btn btn-danger btn-sm" onclick="deleteStudent(${index})">
                    <i class="fas fa-trash"></i> Delete
                </button>
            </td>
        `;
        
        studentsTableBody.appendChild(row);
    });
}

// Filter students
function filterStudents() {
    const department = filterDepartment.value;
    const semester = filterSemester.value;
    const houseTest = filterHouseTest.value;
    
    const rows = studentsTableBody.querySelectorAll('tr');
    
    rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        if (cells.length === 0) return;
        
        const rowDepartment = cells[2].textContent;
        const rowSemester = cells[3].textContent.replace(' Semester', '');
        const rowHouseTest = cells[4].textContent.toLowerCase().replace('house test ', 'house');
        
        const departmentMatch = !department || rowDepartment === department;
        const semesterMatch = !semester || rowSemester === semester;
        const houseTestMatch = !houseTest || rowHouseTest === houseTest;
        
        if (departmentMatch && semesterMatch && houseTestMatch) {
            row.style.display = '';
        } else {
            row.style.display = 'none';
        }
    });
}

// Edit student
function editStudent(index) {
    const student = students[index];
    
    // Fill the form with student data
    document.getElementById('studentRollNo').value = student.rollNo;
    document.getElementById('studentName').value = student.name;
    document.getElementById('studentDepartment').value = student.department;
    document.getElementById('studentSemester').value = student.semester || '';
    
    // Select house test
    houseTestOptions.forEach(option => {
        option.classList.remove('selected');
        if (option.dataset.test === student.houseTest) {
            option.classList.add('selected');
            selectedHouseTest.value = student.houseTest;
        }
    });
    
    // Clear all fields first
    clearStudentForm();
    
    // Fill theory fields
    for (let i = 0; i < student.subjects.length; i++) {
        if (i < 6) { // Ensure we don't exceed 6 subjects
            document.getElementById(`subject${i+1}`).value = student.subjects[i];
            document.getElementById(`marks${i+1}`).value = student.marks[i];
        }
    }
    
    // Fill practical fields
    for (let i = 0; i < student.practicals.length; i++) {
        if (i < 6) {
            document.getElementById(`practicalSubject${i+1}`).value = student.practicals[i];
            document.getElementById(`practicalMarks${i+1}`).value = student.practicalMarks[i];
        }
    }
    
    // Fill assignment fields
    for (let i = 0; i < student.assignments.length; i++) {
        if (i < 6) {
            document.getElementById(`assignmentSubject${i+1}`).value = student.assignments[i];
            document.getElementById(`assignmentMarks${i+1}`).value = student.assignmentMarks[i];
        }
    }
    
    // Fill seminar fields
    for (let i = 0; i < student.seminars.length; i++) {
        if (i < 6) {
            document.getElementById(`seminarSubject${i+1}`).value = student.seminars[i];
            document.getElementById(`seminarMarks${i+1}`).value = student.seminarMarks[i];
        }
    }
    
    // Remove the student from the array (will be re-added when saved)
    students.splice(index, 1);
    
    showToast('Student record loaded for editing', 'success');
}

// Delete student
function deleteStudent(index) {
    if (confirm('Are you sure you want to delete this student record?')) {
        const student = students[index];
        students.splice(index, 1);
        renderStudentsTable();
        
        // Add notification
        const notification = {
            id: Date.now(),
            title: "Student Deleted",
            message: `Deleted ${student.name} (${student.rollNo}) from records`,
            time: "Just now",
            read: false
        };
        notifications.unshift(notification);
        renderNotifications();
        updateUnreadCount();
        
        showToast('Student record deleted successfully!');
    }
}

// Clear student form
function clearStudentForm() {
    document.getElementById('studentRollNo').value = '';
    document.getElementById('studentName').value = '';
    document.getElementById('studentDepartment').value = '';
    document.getElementById('studentSemester').value = '';
    
    houseTestOptions.forEach(option => option.classList.remove('selected'));
    selectedHouseTest.value = '';
    
    // Clear all subject fields
    for (let i = 1; i <= 6; i++) {
        document.getElementById(`subject${i}`).value = '';
        document.getElementById(`marks${i}`).value = '';
        document.getElementById(`practicalSubject${i}`).value = '';
        document.getElementById(`practicalMarks${i}`).value = '';
        document.getElementById(`assignmentSubject${i}`).value = '';
        document.getElementById(`assignmentMarks${i}`).value = '';
        document.getElementById(`seminarSubject${i}`).value = '';
        document.getElementById(`seminarMarks${i}`).value = '';
    }
    
    // Reset to theory tab
    switchMarksType('theory');
}

// Save all student data
function saveAllStudentData() {
    localStorage.setItem('studentData', JSON.stringify(students));
    showToast('All student data has been saved successfully!');
}

// Add new subject
function addSubject(e) {
    e.preventDefault();
    
    const name = document.getElementById('subjectName').value;
    const department = document.getElementById('subjectDepartment').value;
    const semester = document.getElementById('subjectSemester').value;
    
    if (!name || !department || !semester) {
        showToast('Please fill all required fields', 'error');
        return;
    }
    
    const subject = {
        name,
        department,
        semester
    };
    
    subjects.push(subject);
    renderSubjectsTable();
    
    // Clear form
    document.getElementById('subjectName').value = '';
    document.getElementById('subjectDepartment').value = '';
    document.getElementById('subjectSemester').value = '';
    
    // Save to localStorage
    localStorage.setItem('subjectData', JSON.stringify(subjects));
    
    showToast('Subject added successfully!');
}

// Render subjects table
function renderSubjectsTable() {
    subjectsTableBody.innerHTML = '';
    
    if (subjects.length === 0) {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td colspan="4" style="text-align: center; color: var(--gray);">
                No subjects found. Add some subjects to get started.
            </td>
        `;
        subjectsTableBody.appendChild(row);
        return;
    }
    
    subjects.forEach((subject, index) => {
        const row = document.createElement('tr');
        
        row.innerHTML = `
            <td>${subject.name}</td>
            <td>${subject.department}</td>
            <td>${subject.semester} Semester</td>
            <td>
                <button class="btn btn-primary btn-sm" onclick="editSubject(${index})">
                    <i class="fas fa-edit"></i> Edit
                </button>
                <button class="btn btn-danger btn-sm" onclick="deleteSubject(${index})">
                    <i class="fas fa-trash"></i> Delete
                </button>
            </td>
        `;
        
        subjectsTableBody.appendChild(row);
    });
}

// Filter subjects
function filterSubjects() {
    const department = subjectFilterDepartment.value;
    const semester = subjectFilterSemester.value;
    
    const rows = subjectsTableBody.querySelectorAll('tr');
    
    rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        if (cells.length === 0) return;
        
        const rowDepartment = cells[1].textContent;
        const rowSemester = cells[2].textContent.replace(' Semester', '');
        
        const departmentMatch = !department || rowDepartment === department;
        const semesterMatch = !semester || rowSemester === semester;
        
        if (departmentMatch && semesterMatch) {
            row.style.display = '';
        } else {
            row.style.display = 'none';
        }
    });
}

// Edit subject
function editSubject(index) {
    const subject = subjects[index];
    
    // Fill the form with subject data
    document.getElementById('subjectName').value = subject.name;
    document.getElementById('subjectDepartment').value = subject.department;
    document.getElementById('subjectSemester').value = subject.semester;
    
    // Remove the subject from the array (will be re-added when saved)
    subjects.splice(index, 1);
    
    showToast('Subject loaded for editing', 'success');
}

// Delete subject
function deleteSubject(index) {
    if (confirm('Are you sure you want to delete this subject?')) {
        subjects.splice(index, 1);
        renderSubjectsTable();
        localStorage.setItem('subjectData', JSON.stringify(subjects));
        showToast('Subject deleted successfully!');
    }
}

// Save settings
function saveSettings(e) {
    e.preventDefault();
    
    // Update current user info
    currentUser.name = settingsName.value;
    currentUser.email = settingsEmail.value;
    currentUser.phone = settingsPhone.value;
    
    // Save password if changed
    const currentPassword = document.getElementById('currentPassword').value;
    const newPassword = document.getElementById('newPassword').value;
    const confirmPassword = document.getElementById('confirmPassword').value;
    
    if (currentPassword && newPassword && confirmPassword) {
        if (currentPassword !== currentUser.password) {
            showToast('Current password is incorrect', 'error');
            return;
        }
        
        if (newPassword !== confirmPassword) {
            showToast('New passwords do not match', 'error');
            return;
        }
        
        currentUser.password = newPassword;
        showToast('Password updated successfully!');
        
        // Clear password fields
        document.getElementById('currentPassword').value = '';
        document.getElementById('newPassword').value = '';
        document.getElementById('confirmPassword').value = '';
    }
    
    // Update in storage
    updateUserInStorage(currentUser);
    updateProfileSection();
    
    showToast('Settings saved successfully!');
}

// Generate report (updated to include all marks types)
function generateReport() {
    const reportType = document.getElementById('reportType').value;
    
    if (!reportType) {
        showToast('Please select a report type', 'error');
        return;
    }
    
    let reportContent = '';
    
    switch (reportType) {
        case 'department':
            reportContent = generateDepartmentReport();
            break;
        case 'semester':
            reportContent = generateSemesterReport();
            break;
        case 'subject':
            reportContent = generateSubjectReport();
            break;
        case 'housetest':
            reportContent = generateHouseTestReport();
            break;
        default:
            reportContent = '<p>No report generated</p>';
    }
    
    reportResults.innerHTML = reportContent;
    showToast('Report generated successfully!');
}

// Generate department report (updated to include all marks types)
function generateDepartmentReport() {
    const departments = {};
    
    students.forEach(student => {
        if (!departments[student.department]) {
            departments[student.department] = {
                count: 0,
                totalTheoryMarks: 0,
                totalPracticalMarks: 0,
                totalAssignmentMarks: 0,
                totalSeminarMarks: 0,
                subjects: {}
            };
        }
        
        departments[student.department].count++;
        
        // Theory marks
        student.marks.forEach(mark => {
            departments[student.department].totalTheoryMarks += mark;
        });
        
        // Practical marks
        student.practicalMarks.forEach(mark => {
            departments[student.department].totalPracticalMarks += mark;
        });
        
        // Assignment marks
        student.assignmentMarks.forEach(mark => {
            departments[student.department].totalAssignmentMarks += mark;
        });
        
        // Seminar marks
        student.seminarMarks.forEach(mark => {
            departments[student.department].totalSeminarMarks += mark;
        });
        
        // Track subjects
        student.subjects.forEach(subject => {
            if (!departments[student.department].subjects[subject]) {
                departments[student.department].subjects[subject] = 0;
            }
            departments[student.department].subjects[subject]++;
        });
    });
    
    let html = '<h4>Department-wise Performance</h4><div class="form-row">';
    
    for (const dept in departments) {
        const deptData = departments[dept];
        const totalSubjects = Object.keys(deptData.subjects).length;
        
        const avgTheoryMarks = deptData.totalTheoryMarks / (deptData.count * totalSubjects);
        const avgPracticalMarks = deptData.totalPracticalMarks / (deptData.count * totalSubjects);
        const avgAssignmentMarks = deptData.totalAssignmentMarks / (deptData.count * totalSubjects);
        const avgSeminarMarks = deptData.totalSeminarMarks / (deptData.count * totalSubjects);
        const overallAvg = (avgTheoryMarks + avgPracticalMarks + avgAssignmentMarks + avgSeminarMarks) / 4;
        
        html += `
            <div class="form-col">
                <div class="card">
                    <div class="card-header">
                        <h3>${dept}</h3>
                    </div>
                    <div class="card-body">
                        <p><strong>Students:</strong> ${deptData.count}</p>
                        <p><strong>Overall Average:</strong> ${overallAvg.toFixed(2)}%</p>
                        <p><strong>Average Marks:</strong></p>
                        <ul>
                            <li>Theory: ${avgTheoryMarks.toFixed(2)}%</li>
                            <li>Practical: ${avgPracticalMarks.toFixed(2)}%</li>
                            <li>Assignment: ${avgAssignmentMarks.toFixed(2)}%</li>
                            <li>Seminar: ${avgSeminarMarks.toFixed(2)}%</li>
                        </ul>
                        <p><strong>Subjects:</strong></p>
                        <ul>
                            ${Object.entries(deptData.subjects).map(([sub, count]) => 
                                `<li>${sub} (${count} students)</li>`
                            ).join('')}
                        </ul>
                    </div>
                </div>
            </div>
        `;
    }
    
    html += '</div>';
    return html;
}

// Generate semester report (updated to include all marks types)
function generateSemesterReport() {
    const semesters = {};
    
    for (let i = 1; i <= 6; i++) {
        semesters[i] = {
            count: 0,
            totalTheoryMarks: 0,
            totalPracticalMarks: 0,
            totalAssignmentMarks: 0,
            totalSeminarMarks: 0,
            subjects: {}
        };
    }
    
    students.forEach(student => {
        const semester = parseInt(student.semester);
        if (semester >= 1 && semester <= 6) {
            semesters[semester].count++;
            
            // Theory marks
            student.marks.forEach(mark => {
                semesters[semester].totalTheoryMarks += mark;
            });
            
            // Practical marks
            student.practicalMarks.forEach(mark => {
                semesters[semester].totalPracticalMarks += mark;
            });
            
            // Assignment marks
            student.assignmentMarks.forEach(mark => {
                semesters[semester].totalAssignmentMarks += mark;
            });
            
            // Seminar marks
            student.seminarMarks.forEach(mark => {
                semesters[semester].totalSeminarMarks += mark;
            });
            
            // Track subjects
            student.subjects.forEach(subject => {
                if (!semesters[semester].subjects[subject]) {
                    semesters[semester].subjects[subject] = 0;
                }
                semesters[semester].subjects[subject]++;
            });
        }
    });
    
    let html = '<h4>Semester-wise Performance</h4><div class="form-row">';
    
    for (const sem in semesters) {
        const semData = semesters[sem];
        if (semData.count === 0) continue;
        
        const totalSubjects = Object.keys(semData.subjects).length;
        
        const avgTheoryMarks = semData.totalTheoryMarks / (semData.count * totalSubjects);
        const avgPracticalMarks = semData.totalPracticalMarks / (semData.count * totalSubjects);
        const avgAssignmentMarks = semData.totalAssignmentMarks / (semData.count * totalSubjects);
        const avgSeminarMarks = semData.totalSeminarMarks / (semData.count * totalSubjects);
        const overallAvg = (avgTheoryMarks + avgPracticalMarks + avgAssignmentMarks + avgSeminarMarks) / 4;
        
        html += `
            <div class="form-col">
                <div class="card">
                    <div class="card-header">
                        <h3>Semester ${sem}</h3>
                    </div>
                    <div class="card-body">
                        <p><strong>Students:</strong> ${semData.count}</p>
                        <p><strong>Overall Average:</strong> ${overallAvg.toFixed(2)}%</p>
                        <p><strong>Average Marks:</strong></p>
                        <ul>
                            <li>Theory: ${avgTheoryMarks.toFixed(2)}%</li>
                            <li>Practical: ${avgPracticalMarks.toFixed(2)}%</li>
                            <li>Assignment: ${avgAssignmentMarks.toFixed(2)}%</li>
                            <li>Seminar: ${avgSeminarMarks.toFixed(2)}%</li>
                        </ul>
                        <p><strong>Subjects:</strong></p>
                        <ul>
                            ${Object.entries(semData.subjects).map(([sub, count]) => 
                                `<li>${sub} (${count} students)</li>`
                            ).join('')}
                        </ul>
                    </div>
                </div>
            </div>
        `;
    }
    
    html += '</div>';
    return html;
}

// Generate subject report (updated to include all marks types)
function generateSubjectReport() {
    const subjectData = {};
    
    students.forEach(student => {
        student.subjects.forEach((subject, index) => {
            if (!subjectData[subject]) {
                subjectData[subject] = {
                    count: 0,
                    totalTheoryMarks: 0,
                    totalPracticalMarks: 0,
                    totalAssignmentMarks: 0,
                    totalSeminarMarks: 0,
                    departments: {},
                    semesters: {}
                };
            }
            
            subjectData[subject].count++;
            
            // Theory marks
            if (student.marks[index]) {
                subjectData[subject].totalTheoryMarks += student.marks[index];
            }
            
            // Practical marks
            if (student.practicalMarks[index]) {
                subjectData[subject].totalPracticalMarks += student.practicalMarks[index];
            }
            
            // Assignment marks
            if (student.assignmentMarks[index]) {
                subjectData[subject].totalAssignmentMarks += student.assignmentMarks[index];
            }
            
            // Seminar marks
            if (student.seminarMarks[index]) {
                subjectData[subject].totalSeminarMarks += student.seminarMarks[index];
            }
            
            // Track departments
            if (!subjectData[subject].departments[student.department]) {
                subjectData[subject].departments[student.department] = 0;
            }
            subjectData[subject].departments[student.department]++;
            
            // Track semesters
            if (!subjectData[subject].semesters[student.semester]) {
                subjectData[subject].semesters[student.semester] = 0;
            }
            subjectData[subject].semesters[student.semester]++;
        });
    });
    
    let html = `
        <h4>Subject-wise Performance</h4>
        <table class="table">
            <thead>
                <tr>
                    <th>Subject</th>
                    <th>Students</th>
                    <th>Theory Avg</th>
                    <th>Practical Avg</th>
                    <th>Assignment Avg</th>
                    <th>Seminar Avg</th>
                    <th>Overall Avg</th>
                    <th>Departments</th>
                    <th>Semesters</th>
                </tr>
            </thead>
            <tbody>
    `;
    
    for (const subject in subjectData) {
        const data = subjectData[subject];
        
        const avgTheoryMarks = data.totalTheoryMarks / data.count;
        const avgPracticalMarks = data.totalPracticalMarks / data.count;
        const avgAssignmentMarks = data.totalAssignmentMarks / data.count;
        const avgSeminarMarks = data.totalSeminarMarks / data.count;
        const overallAvg = (avgTheoryMarks + avgPracticalMarks + avgAssignmentMarks + avgSeminarMarks) / 4;
        
        html += `
            <tr>
                <td>${subject}</td>
                <td>${data.count}</td>
                <td>${avgTheoryMarks.toFixed(2)}%</td>
                <td>${avgPracticalMarks.toFixed(2)}%</td>
                <td>${avgAssignmentMarks.toFixed(2)}%</td>
                <td>${avgSeminarMarks.toFixed(2)}%</td>
                <td>${overallAvg.toFixed(2)}%</td>
                <td>
                    ${Object.entries(data.departments).map(([dept, count]) => 
                        `${dept} (${count})`
                    ).join(', ')}
                </td>
                <td>
                    ${Object.entries(data.semesters).map(([sem, count]) => 
                        `Sem ${sem} (${count})`
                    ).join(', ')}
                </td>
            </tr>
        `;
    }
    
    html += '</tbody></table>';
    return html;
}

// Generate house test report (updated to include all marks types)
function generateHouseTestReport() {
    const testData = {
        house1: { count: 0, totalTheoryMarks: 0, totalPracticalMarks: 0, totalAssignmentMarks: 0, totalSeminarMarks: 0 },
        house2: { count: 0, totalTheoryMarks: 0, totalPracticalMarks: 0, totalAssignmentMarks: 0, totalSeminarMarks: 0 },
        house3: { count: 0, totalTheoryMarks: 0, totalPracticalMarks: 0, totalAssignmentMarks: 0, totalSeminarMarks: 0 }
    };
    
    students.forEach(student => {
        if (testData[student.houseTest]) {
            testData[student.houseTest].count++;
            
            // Theory marks
            student.marks.forEach(mark => {
                testData[student.houseTest].totalTheoryMarks += mark;
            });
            
            // Practical marks
            student.practicalMarks.forEach(mark => {
                testData[student.houseTest].totalPracticalMarks += mark;
            });
            
            // Assignment marks
            student.assignmentMarks.forEach(mark => {
                testData[student.houseTest].totalAssignmentMarks += mark;
            });
            
            // Seminar marks
            student.seminarMarks.forEach(mark => {
                testData[student.houseTest].totalSeminarMarks += mark;
            });
        }
    });
    
    let html = '<h4>House Test Comparison</h4><div class="form-row">';
    
    for (const test in testData) {
        const data = testData[test];
        if (data.count === 0) continue;
        
        const totalSubjects = 6; // Assuming 6 subjects
        const avgTheoryMarks = data.totalTheoryMarks / (data.count * totalSubjects);
        const avgPracticalMarks = data.totalPracticalMarks / (data.count * totalSubjects);
        const avgAssignmentMarks = data.totalAssignmentMarks / (data.count * totalSubjects);
        const avgSeminarMarks = data.totalSeminarMarks / (data.count * totalSubjects);
        const overallAvg = (avgTheoryMarks + avgPracticalMarks + avgAssignmentMarks + avgSeminarMarks) / 4;
        
        html += `
            <div class="form-col">
                <div class="card">
                    <div class="card-header">
                        <h3>${test.replace('house', 'House Test ')}</h3>
                    </div>
                    <div class="card-body">
                        <p><strong>Students:</strong> ${data.count}</p>
                        <p><strong>Overall Average:</strong> ${overallAvg.toFixed(2)}%</p>
                        <p><strong>Average Marks:</strong></p>
                        <ul>
                            <li>Theory: ${avgTheoryMarks.toFixed(2)}%</li>
                            <li>Practical: ${avgPracticalMarks.toFixed(2)}%</li>
                            <li>Assignment: ${avgAssignmentMarks.toFixed(2)}%</li>
                            <li>Seminar: ${avgSeminarMarks.toFixed(2)}%</li>
                        </ul>
                    </div>
                </div>
            </div>
        `;
    }
    
    html += '</div>';
    return html;
}

// Export to Excel
function exportToExcel() {
    const exportType = document.getElementById('exportType').value;
    
    if (!exportType) {
        showToast('Please select data type to export', 'error');
        return;
    }
    
    let data = [];
    let fileName = '';
    
    switch (exportType) {
        case 'students':
            data = students.map(student => ({
                'Roll No': student.rollNo,
                'Name': student.name,
                'Department': student.department,
                'Semester': student.semester,
                'House Test': student.houseTest.replace('house', 'House Test '),
                'Subjects': student.subjects.join(', '),
                'Theory Marks': student.marks.join(', '),
                'Practicals': student.practicals.join(', '),
                'Practical Marks': student.practicalMarks.join(', '),
                'Assignments': student.assignments.join(', '),
                'Assignment Marks': student.assignmentMarks.join(', '),
                'Seminars': student.seminars.join(', '),
                'Seminar Marks': student.seminarMarks.join(', ')
            }));
            fileName = 'student_records.xlsx';
            break;
            
        case 'marks':
            data = students.flatMap(student => 
                student.subjects.map((subject, index) => ({
                    'Roll No': student.rollNo,
                    'Name': student.name,
                    'Department': student.department,
                    'Semester': student.semester,
                    'House Test': student.houseTest.replace('house', 'House Test '),
                    'Subject': subject,
                    'Theory Marks': student.marks[index],
                    'Practical': student.practicals[index] || '',
                    'Practical Marks': student.practicalMarks[index] || '',
                    'Assignment': student.assignments[index] || '',
                    'Assignment Marks': student.assignmentMarks[index] || '',
                    'Seminar': student.seminars[index] || '',
                    'Seminar Marks': student.seminarMarks[index] || ''
                }))
            );
            fileName = 'marks_data.xlsx';
            break;
            
        case 'subjects':
            data = subjects.map(subject => ({
                'Subject Name': subject.name,
                'Department': subject.department,
                'Semester': subject.semester
            }));
            fileName = 'subject_list.xlsx';
            break;
    }
    
    if (data.length === 0) {
        showToast('No data to export', 'error');
        return;
    }
    
    // Create worksheet
    const ws = XLSX.utils.json_to_sheet(data);
    
    // Create workbook
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Sheet1");
    
    // Export to Excel file
    XLSX.writeFile(wb, fileName);
    
    showToast(`Exported ${exportType} data to Excel successfully!`);
}

// Export to PDF
function exportToPDF() {
    const exportType = document.getElementById('exportType').value;
    
    if (!exportType) {
        showToast('Please select data type to export', 'error');
        return;
    }
    
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    
    let data = [];
    let headers = [];
    let title = '';
    
    switch (exportType) {
        case 'students':
            data = students.map(student => [
                student.rollNo,
                student.name,
                student.department,
                student.semester,
                student.houseTest.replace('house', 'House Test '),
                student.subjects.join(', '),
                student.marks.join(', '),
                student.practicals.join(', '),
                student.practicalMarks.join(', '),
                student.assignments.join(', '),
                student.assignmentMarks.join(', '),
                student.seminars.join(', '),
                student.seminarMarks.join(', ')
            ]);
            headers = ['Roll No', 'Name', 'Department', 'Semester', 'House Test', 'Subjects', 'Theory Marks', 'Practicals', 'Practical Marks', 'Assignments', 'Assign Marks', 'Seminars', 'Sem Marks'];
            title = 'Student Records';
            break;
            
        case 'marks':
            data = students.flatMap(student => 
                student.subjects.map((subject, index) => [
                    student.rollNo,
                    student.name,
                    subject,
                    student.marks[index],
                    student.practicals[index] || '',
                    student.practicalMarks[index] || '',
                    student.assignments[index] || '',
                    student.assignmentMarks[index] || '',
                    student.seminars[index] || '',
                    student.seminarMarks[index] || ''
                ])
            );
            headers = ['Roll No', 'Name', 'Subject', 'Theory', 'Practical', 'Prac Marks', 'Assignment', 'Assign Marks', 'Seminar', 'Sem Marks'];
            title = 'Marks Data';
            break;
            
        case 'subjects':
            data = subjects.map(subject => [
                subject.name,
                subject.department,
                subject.semester
            ]);
            headers = ['Subject Name', 'Department', 'Semester'];
            title = 'Subject List';
            break;
    }
    
    if (data.length === 0) {
        showToast('No data to export', 'error');
        return;
    }
    
    // Add title
    doc.setFontSize(16);
    doc.text(title, 14, 15);
    
    // Add table
    doc.autoTable({
        head: [headers],
        body: data,
        startY: 25,
        theme: 'grid',
        headStyles: {
            fillColor: [67, 97, 238],
            textColor: 255
        }
    });
    
    // Save the PDF
    doc.save(`${title.toLowerCase().replace(' ', '_')}.pdf`);
    
    showToast(`Exported ${exportType} data to PDF successfully!`);
}

function printReport() {
    const printContent = reportResults.innerHTML;
    if (!printContent) {
        showToast('No report content to print', 'error');
        return;
    }

    // Create a temporary div for printing
    const printDiv = document.createElement('div');
    printDiv.innerHTML = printContent;
    document.body.appendChild(printDiv);
    
    // Print and clean up
    window.print();
    
    // Remove the temporary div after a short delay
    setTimeout(() => {
        document.body.removeChild(printDiv);
    }, 500);
}

// Toggle profile dropdown
function toggleProfileDropdown(e) {
    e.stopPropagation();
    profileDropdown.classList.toggle('active');
    notificationDropdown.classList.remove('active');
    
    if (profileDropdown.classList.contains('active')) {
        document.addEventListener('click', closeProfileDropdown);
    } else {
        document.removeEventListener('click', closeProfileDropdown);
    }
}

// Close profile dropdown
function closeProfileDropdown() {
    profileDropdown.classList.remove('active');
    document.removeEventListener('click', closeProfileDropdown);
}

// Toggle notification dropdown
function toggleNotificationDropdown(e) {
    e.stopPropagation();
    notificationDropdown.classList.toggle('active');
    profileDropdown.classList.remove('active');
    
    if (notificationDropdown.classList.contains('active')) {
        document.addEventListener('click', closeNotificationDropdown);
    } else {
        document.removeEventListener('click', closeNotificationDropdown);
    }
}

// Close notification dropdown
function closeNotificationDropdown() {
    notificationDropdown.classList.remove('active');
    document.removeEventListener('click', closeNotificationDropdown);
}

// Render notifications
function renderNotifications() {
    notificationList.innerHTML = '';
    
    if (notifications.length === 0) {
        notificationList.innerHTML = '<div class="notification-item" style="text-align: center; color: var(--gray);">No notifications</div>';
        return;
    }
    
    notifications.forEach(notification => {
        const item = document.createElement('div');
        item.className = `notification-item ${notification.read ? '' : 'unread'}`;
        item.innerHTML = `
            <div class="notification-title">
                <strong>${notification.title}</strong>
                <small>${notification.time}</small>
            </div>
            <div class="notification-message">${notification.message}</div>
        `;
        
        item.addEventListener('click', () => {
            if (!notification.read) {
                notification.read = true;
                item.classList.remove('unread');
                updateUnreadCount();
            }
        });
        
        notificationList.appendChild(item);
    });
}

// Update unread notification count
function updateUnreadCount() {
    const unreadCount = notifications.filter(n => !n.read).length;
    const badge = document.querySelector('.notification-badge');
    
    if (unreadCount > 0) {
        badge.textContent = unreadCount;
        badge.style.display = 'flex';
    } else {
        badge.style.display = 'none';
    }
}

// Show toast notification
function showToast(message, type = 'success') {
    const toast = document.createElement('div');
    toast.className = `toast toast-${type}`;
    toast.innerHTML = `
        <i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'}"></i>
        ${message}
    `;
    toastContainer.appendChild(toast);
    
    // Remove toast after 5 seconds
    setTimeout(() => {
        toast.classList.add('fade-out');
        setTimeout(() => toast.remove(), 300);
    }, 5000);
}

// Navigate to section
function navigateToSection(section) {
    // Hide all sections
    document.querySelectorAll('.section-content').forEach(content => {
        content.classList.remove('active');
    });
    
    // Show selected section
    document.getElementById(`${section}Section`).classList.add('active');
    
    // Update active menu item
    document.querySelectorAll('.menu-item').forEach(item => {
        item.classList.toggle('active', item.dataset.section === section);
    });
    
    // Update page title
    const titles = {
        dashboard: 'Dashboard',
        students: 'Student Management',
        subjects: 'Subject Management',
        reports: 'Reports',
        settings: 'System Settings'
    };
    document.getElementById('pageTitle').textContent = titles[section];
    
    currentSection = section;
}

// Edit profile
function editProfile() {
    profileModal.classList.add('active');
}

// Logout
function logout() {
    if (confirm('Are you sure you want to logout?')) {
        currentUser = null;
        localStorage.removeItem('currentUser');
        showToast('You have been logged out successfully', 'success');
        
        // Clear the UI
        userAvatar.textContent = 'JD';
        profileName.textContent = 'John Doe';
        profileEmail.textContent = 'john.doe@example.com';
        
        // Show auth modal
        setTimeout(() => {
            showAuthModal();
        }, 1000);
    }
}

// Update dashboard stats
function updateDashboardStats() {
    // Total students
    document.getElementById('totalStudents').textContent = students.length;
    
    // Total subjects
    document.getElementById('totalSubjects').textContent = subjects.length;
    
    // Average marks
    if (students.length > 0) {
        let totalMarks = 0;
        let totalSubjects = 0;
        
        students.forEach(student => {
            student.marks.forEach(mark => {
                totalMarks += mark;
                totalSubjects++;
            });
            
            student.practicalMarks.forEach(mark => {
                if (mark) {
                    totalMarks += mark;
                    totalSubjects++;
                }
            });
            
            student.assignmentMarks.forEach(mark => {
                if (mark) {
                    totalMarks += mark;
                    totalSubjects++;
                }
            });
            
            student.seminarMarks.forEach(mark => {
                if (mark) {
                    totalMarks += mark;
                    totalSubjects++;
                }
            });
        });
        
        const avgMarks = totalSubjects > 0 ? (totalMarks / totalSubjects) : 0;
        document.getElementById('avgMarks').textContent = avgMarks.toFixed(1) + '%';
    }
    
    // Unread notifications
    const unreadCount = notifications.filter(n => !n.read).length;
    document.getElementById('unreadNotif').textContent = unreadCount;
    
    // Update recent activity
    updateRecentActivity();
}

// Update recent activity
function updateRecentActivity() {
    const activityList = document.getElementById('activityList');
    activityList.innerHTML = '';
    
    if (students.length === 0 && notifications.length === 0) {
        activityList.innerHTML = '<div class="activity-item"><p>No recent activity</p></div>';
        return;
    }
    
    // Add student additions as activities
    const recentStudents = students.slice(0, 3).reverse();
    recentStudents.forEach(student => {
        const activityItem = document.createElement('div');
        activityItem.className = 'activity-item';
        activityItem.innerHTML = `
            <div class="activity-icon">
                <i class="fas fa-user-plus"></i>
            </div>
            <div class="activity-content">
                <p>Added ${student.name} (${student.rollNo})</p>
                <small class="activity-time">${formatActivityTime(student.addedDate)}</small>
            </div>
        `;
        activityList.appendChild(activityItem);
    });
    
    // Add notifications as activities
    const recentNotifs = notifications.slice(0, 3);
    recentNotifs.forEach(notif => {
        const activityItem = document.createElement('div');
        activityItem.className = 'activity-item';
        activityItem.innerHTML = `
            <div class="activity-icon">
                <i class="fas fa-bell"></i>
            </div>
            <div class="activity-content">
                <p>${notif.title}: ${notif.message}</p>
                <small class="activity-time">${notif.time}</small>
            </div>
        `;
        activityList.appendChild(activityItem);
    });
}

// Format activity time
function formatActivityTime(dateString) {
    const date = new Date(dateString);
    const now = new Date();
    const diff = now - date;
    
    const minutes = Math.floor(diff / 60000);
    if (minutes < 60) return `${minutes} min ago`;
    
    const hours = Math.floor(minutes / 60);
    if (hours < 24) return `${hours} hr ago`;
    
    const days = Math.floor(hours / 24);
    if (days < 7) return `${days} day${days === 1 ? '' : 's'} ago`;
    
    return date.toLocaleDateString();
}

// Initialize the app when DOM is loaded
document.addEventListener('DOMContentLoaded', initApp);

// Make functions available globally for inline event handlers
window.editStudent = editStudent;
window.deleteStudent = deleteStudent;
window.editSubject = editSubject;
window.deleteSubject = deleteSubject;
window.navigateToSection = navigateToSection;

    </script>
  
</body>
</html>